// Fallback variables
$grid--gutter ?= 20px

// The below markup fix is needed for uncompressed HTML
$is-html-compressed ?= false

// Default grid names & count names
$grid--count-names ?= one two three four five six seven eight nine ten eleven twelve thirteen fourteen fifteen sixteen
$grid--size-names ?= whole half third quarter fifth sixth seventh eighth ninth tenth eleventh twelfth thirteenth fourteenth fifteenth sixteenth


grid-base($namespace = '', $grid-base--gutter = $grid--gutter)
  .grid{$namespace}
    margin-left -($grid-base--gutter)
    if $is-html-compressed
      letter-spacing -0.31em

  .grid__item
    _grid-gutter--item($grid-base--gutter)
    vertical-align top
    display inline-block
    width 100% // Set default width
    if $use-markup-fix != true
      letter-spacing normal


//
// GRID MODIFIERS
//

grid-modifier($modifier = '', $grid-modifier--gutter = $grid--gutter)
  .grid--{$modifier}
    margin-left -($grid-modifier--gutter)

    & > .grid__item
      _grid-gutter--item($grid-modifier--gutter)


//
// GRID ITEM GUTTER
//

_grid-gutter--item($g)
  if unit($g) == '%'
    $scale = unit( 100 / (100 + $g), '')
    padding-left ($scale * $g)%
  else
    padding-left $g


//
// GRID WIDTHS
// The base mixin, used to set up grid width styles.
//

grid-widths()
  $namespace = arguments[0]
  $columns = arguments[1]
  _grid($namespace, $columns, 'width')


//
// GRID WIDTHS BUILDER
// This mixin should not be called directly
//

_grid($namespace, $columns, $property)
  for $column, $i in $columns
    $grid = $grid--size-names[$column - 1]
    if ($column - 1 > 0)
      // Loop trough col size names
      for $size, $j in $grid--count-names
        // Check if we need this size
        if $j < ($column - 1)
          $plural = $j is 0 ? '' : 's'
          .{$namespace}{$size}-{$grid[0]}{$plural}
            {$property} ($j+1) * (100% / $column)
    else
      .{$namespace}{$grid--count-names[0]}-{$grid[0]}
        {$property} 100%
